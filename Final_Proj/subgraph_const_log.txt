======================================================================
FULL NETWORK THRESHOLDING ANALYSIS PIPELINE
======================================================================
Data directory: ./data
Output directory: ./threshold_analysis_output
Force recompute: True

Computing full LCC graph...
Loading relationships CSV...
Loaded 3,339,267 relationships
Aggregating edges (counting duplicates as weight)...
Aggregated to 2,897,134 unique edges
Loading entity nodes from nodes-entities.csv...
  Processing 814,344 entity nodes...
Loading officer nodes from nodes-officers.csv...
  Processing 771,315 officer nodes...
Loading intermediary nodes from nodes-intermediaries.csv...
  Processing 25,629 intermediary nodes...
Loading address nodes from nodes-addresses.csv...
  Processing 402,246 address nodes...
Loading other nodes from nodes-others.csv...
  Processing 2,989 other nodes...
Loaded 2,016,523 total node attributes

Building full graph...
Adding edges with attributes...
Graph built: 2,016,165 nodes, 2,896,167 edges
Adding node attributes...
Added attributes to 2,016,165 / 2,016,165 nodes

Extracting largest connected component...
Found 33068 connected components
Top 5 component sizes: [942172, 284329, 161754, 161499, 91168]
LCC: 942,172 nodes (46.7% of total)
     1,363,966 edges (47.1% of total)
Saving full LCC graph to threshold_analysis_output/graph_full_lcc.pkl...
✓ Saved: threshold_analysis_output/graph_full_lcc.pkl
Computing annotated graph...

Annotating Power Players...
Found 62 Power Players in network (out of 172 expected)
Saving annotated graph to threshold_analysis_output/graph_full_annotated.pkl...
✓ Saved: threshold_analysis_output/graph_full_annotated.pkl
Power Players in network: 62
Computing centralities...

Computing centralities on full network...
This may take significant time for large graphs.
1/4 Computing degree centrality...
2/4 Computing weighted degree...
3/4 Computing PageRank (weight='weight')...
PageRank failed: No module named 'scipy'
4/4 Computing approximate betweenness (k=1000)...
Centralities computed successfully.
Saving centralities to threshold_analysis_output/centralities_full.pkl...
✓ Saved: threshold_analysis_output/centralities_full.pkl

======================================================================
CREATING THRESHOLDED SUBGRAPHS
======================================================================
✓ full: 942,172 nodes

Edge weight thresholding...
  weight_2: Creating...
  weight_2: 1,845 nodes (created)
  weight_3: Creating...
  weight_3: 34 nodes (created)
  weight_5: Creating...
  weight_5: 13 nodes (created)
  weight_10: Creating...
  weight_10: 6 nodes (created)

Centrality percentile thresholding...
  betweenness_top10: Creating...
  betweenness_top10: 93,886 nodes (created)
  betweenness_top5: Creating...
  betweenness_top5: 46,773 nodes (created)
  betweenness_top1: Creating...
  betweenness_top1: 8,972 nodes (created)
  weighted_degree_top10: Creating...
  weighted_degree_top10: 89,487 nodes (created)
  weighted_degree_top5: Creating...
  weighted_degree_top5: 53,658 nodes (created)
  weighted_degree_top1: Creating...
  weighted_degree_top1: 3,894 nodes (created)

K-core decomposition...
  kcore_3: Creating...
  kcore_3: 107,319 nodes (created)
  kcore_5: Creating...
  kcore_5: 14,577 nodes (created)
  kcore_10: Creating...
  kcore_10: 1,686 nodes (created)
  kcore_20: Creating...
  kcore_20: 478 nodes (created)

Power Player ego networks...
  ego_1hop: Creating...
  Expanding from 62 Power Players to distance 1...
    Collected 243 nodes
  ego_1hop: 243 nodes (created)
  ego_2hop: Creating...
  Expanding from 62 Power Players to distance 2...
    Collected 1,201 nodes
  ego_2hop: 1,201 nodes (created)
  ego_3hop: Creating...
  Expanding from 62 Power Players to distance 3...
    Collected 76,610 nodes
  ego_3hop: 76,610 nodes (created)

Relationship type filtering...
  Top 3 relationship types: ['officer_of', 'intermediary_of', 'registered_address']
  reltype_officer_of: Creating...
  reltype_officer_of: 151,964 nodes (created)
  reltype_intermediary_of: Creating...
  reltype_intermediary_of: 14,902 nodes (created)

Total: 20 subgraphs

======================================================================
ANALYZING SUBGRAPHS
======================================================================

======================================================================
ANALYZING SUBGRAPHS
======================================================================
✓ Saved comparison results: threshold_analysis_output/thresholding_comparison.csv

======================================================================
SUMMARY OF THRESHOLDING RESULTS
======================================================================
                   name  nodes   edges  density  power_players  power_player_retention_pct  unique_rel_types
                   full 942172 1363966 0.000003             62                  100.000000                11
     reltype_officer_of 151964  211958 0.000018              2                    3.225806                 1
                kcore_3 107319  342763 0.000060             10                   16.129032                 9
      betweenness_top10  93886  177706 0.000040              9                   14.516129                11
  weighted_degree_top10  89487  262162 0.000065              7                   11.290323                 9
               ego_3hop  76610  133936 0.000046             62                  100.000000                 8
   weighted_degree_top5  53658  172817 0.000120              5                    8.064516                 9
       betweenness_top5  46773   86021 0.000079              5                    8.064516                11
reltype_intermediary_of  14902   14901 0.000134              0                    0.000000                 1
                kcore_5  14577   78233 0.000736              3                    4.838710                 7
       betweenness_top1   8972   14442 0.000359              3                    4.838710                 9
   weighted_degree_top1   3894   12574 0.001659              0                    0.000000                 7
               weight_2   1845    1853 0.001089              0                    0.000000                 2
               kcore_10   1686   17956 0.012641              0                    0.000000                 5
               ego_2hop   1201    1795 0.002491             62                  100.000000                 5
               kcore_20    478    8487 0.074445              0                    0.000000                 3
               ego_1hop    243     192 0.006530             62                  100.000000                 4
               weight_3     34      33 0.058824              0                    0.000000                 1
               weight_5     13      15 0.192308              0                    0.000000                 1
              weight_10      6       5 0.333333              0                    0.000000                 1

======================================================================
PIPELINE COMPLETE
======================================================================
All outputs saved to: threshold_analysis_output

Key files:
  - graph_full_lcc.pkl: Full LCC network
  - graph_full_annotated.pkl: LCC with Power Player annotations
  - centralities_full.pkl: Centrality measures
  - subgraph_*.pkl: 20 thresholded subgraphs
  - thresholding_comparison.csv: Comparative statistics
